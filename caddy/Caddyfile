shieldvpn.ru {
    # Включаем логирование
    log

    # Отдаем простую страницу-заглушку, чтобы ваш домен не выглядел пустым
    @fallback not path /vless-ws*
    handle @fallback {
        respond "Hello! This is a private server." 200
    }

    # Перенаправляем запросы по секретному пути на Xray
    handle_path /vless-ws* {
        # Используем websocket пресет и указываем заголовки
        reverse_proxy vpn_xray:10000 {
            header_up Host {http.request.host}
            header_up X-Real-IP {http.request.remote}
            header_up X-Forwarded-For {http.request.remote}
            header_up X-Forwarded-Port {http.request.port}
            header_up X-Forwarded-Proto {http.request.scheme}
        }
    }

    # Включаем автоматическое управление TLS-сертификатами
    tls jacob.tokarev@icloud.com
}